<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Jadwal Sholat - Auto Print</title>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://rawcdn.githack.com/DoersGuild/jQuery.print/master/jQuery.print.min.js"></script>
<style>
body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
#jadwal { background: white; padding: 10px; border: 1px solid #ccc; }
h2 { margin-bottom: 20px; }
</style>
</head>
<body>

<h2 id="judul">Memuat jadwal...</h2>
<div id="jadwal"></div>

<script>
// Semua KOTA_ID dari bot
const kotaIdMapping = {
    "aceh": 1, "alahan panjang": 2, "amboina": 3, "ambon": 4, "amuntai": 5, "anyer": 6,
    "arosbaya": 7, "baitul musthofa": 265, "baliage": 9, "balikpapan": 10, "banda aceh": 11,
    "bandar lampung": 12, "bandung": 13, "banggai": 14, "bangka": 15, "bangkalan": 16, "bangkinan": 17,
    "bangko": 18, "banjar": 19, "banjarmasin": 20, "banjarnegara": 21, "banten": 22, "bantul": 23,
    "banyumas": 24, "banyuwangi": 25, "barabai": 26, "batang": 27, "baturaja": 28, "batusangkar": 29,
    "baubau": 30, "bekasi": 31, "bengkalis": 32, "bengkulu": 33, "bima": 34, "binjai": 35,
    "bireun": 36, "blangkajeren": 37, "blega": 38, "blitar": 39, "blora": 40, "bogor": 41,
    "bojonegoro": 42, "bondowoso": 43, "bontang": 44, "bonthain": 45, "boyolali": 46, "brebes": 47,
    "bukittinggi": 48, "bulukumba": 49, "bungah": 50, "buntok": 51, "calang": 52, "cepu": 53,
    "ciamis": 54, "cianjur": 55, "cibinong": 56, "cijulang": 57, "cikajang": 58, "cilacap": 59,
    "cilegon": 60, "cimahi": 61, "cirebon": 62, "curup": 63, "demak": 64, "denpasar": 65,
    "dilli": 66, "dobo": 67, "dompu": 68, "donggala": 69, "dumai": 70, "durjan": 71, "endeh": 72,
    "enrekang": 73, "fakfak": 74, "garut": 75, "gebang arosbaya": 76, "gebang bangkalan": 77,
    "glagah": 78, "glagah lamongan": 79, "gombong": 80, "gorontalo": 81, "grajakan": 82,
    "gresik condrodipo": 83, "gresik": 84, "gunung sitoli": 85, "idi": 86, "indramayu": 87,
    "jakarta": 88, "jambi": 89, "jampea": 90, "jatinegara": 91, "jayapura": 92, "jember": 93,
    "jeneponto": 94, "jepara": 95, "jombang": 96, "kabanjahe": 97, "kadungdung": 98, "kalabahi": 99,
    "kalianda": 100, "kandangan": 101, "kangean": 102, "karang nunggal": 103, "karanganyar": 104,
    "karawang": 105, "kayuagung": 106, "kebayoran": 107, "kebumen": 108, "kediri": 109,
    "kefamenanu": 110, "kendal": 111, "kendari": 112, "ketapang kalimantan": 113, "ketapang madura": 114,
    "klaten": 115, "kolaka": 116, "kotabaru": 117, "kotabumi": 118, "kotamobago": 119, "kraksan": 120,
    "krui": 121, "kuala kapuas": 122, "kuala simpang": 123, "kuala tungkal": 124, "kudus": 125,
    "kuningan": 126, "kupang": 127, "kutacane": 128, "kutai": 129, "labuha": 130, "labuhan": 131,
    "lahat": 132, "lamongan": 133, "langsa": 134, "larantuka": 135, "lhokseimawe": 136, "lhoktukon": 137,
    "lubuk linggau": 138, "lubuk sikaping": 139, "lumajang": 140, "luwuk": 141, "madiun": 142,
    "magetan": 143, "majalengka": 144, "majene": 145, "makale": 146, "malang": 147, "malingping": 148,
    "mamuju": 149, "manado": 150, "maninjau": 151, "manokwari": 152, "manyar": 153, "marabahan": 154,
    "maros": 155, "martapura": 156, "mataram": 157, "maumere": 158, "medan": 159, "menado": 160,
    "merak": 161, "merauke": 162, "metro": 163, "meulaboh": 164, "meureudeu": 165, "mojokerto": 166,
    "morotai": 167, "muara bulian": 168, "muara bungo": 169, "muara enim": 170, "muara labuh": 171,
    "muara tewe": 172, "mukomuko": 173, "nabire": 174, "negara bali": 175, "negara kalsel": 176,
    "nganjuk": 177, "ngawi": 178, "nunukan": 179, "pacitan": 180, "padang": 181, "padang panjang": 182,
    "padang sidampuan": 183, "padang sidempuan": 184, "pagantenan": 185, "painan": 186, "pakan baru": 187,
    "palangkaraya": 188, "palembang": 189, "palopo": 190, "palu": 191, "pamanukan": 192, "pamekasan": 193,
    "pameungpeuk": 194, "pandegelang": 195, "pangkajene": 196, "pangkal pinang": 197, "pangkalan bun": 198,
    "parepare": 199, "pariaman": 200, "pasir pangarayan": 201, "pasuruan": 202, "pati": 203,
    "payakumbuh": 204, "pekalongan": 205, "pekanbaru": 206, "pelabuhan ratu": 207, "pemalang": 208,
    "pematang siantar": 209, "pengalengan": 210, "pinrang": 211, "polewali": 212, "ponorogo": 213,
    "pontianak": 214, "poso": 215, "ppmi assalaam": 216, "probolinggo": 217, "purbalingga": 218,
    "purwakarta": 219, "purwodadi": 220, "purwokerto": 221, "purworejo": 222, "putusibah": 223,
    "raba": 224, "raha": 225, "rangkasbitung": 226, "rantau": 227, "rantau prapat": 228, "rembang": 229,
    "rengat": 230, "ruteng": 231, "sabang": 232, "salatiga": 233, "samarinda": 234, "sambas": 235,
    "sampang": 236, "sampit": 237, "sanggau": 238, "sawah lunto": 239, "sekayu": 240, "selat panjang": 241,
    "selong": 242, "semarang": 243, "sepuluh": 244, "serang": 245, "sibolga": 246, "sidenreng rappang": 247,
    "sidikalang": 248, "sidoarjo": 249, "sigli": 250, "sijunjung": 251, "sinabang": 252,
    "sindang barang": 253, "singaraja": 254, "singkawang": 255, "singkil": 256, "sinjai": 257,
    "sintang": 258, "situbondo": 259, "sleman": 260, "solo": 261, "solok": 262, "sorong": 263,
    "sragen": 264, "subang": 266, "sukabumi": 267, "sukoharjo": 268, "suliki": 269, "sumbawa besar": 270,
    "sumedang": 271, "sumenep": 272, "sunbgu minasa": 273, "sungai liat": 274, "sungai penuh": 275,
    "surabaya": 276, "surakarta": 277, "tabanan": 278, "tahuna": 279, "takalar": 280, "takengeun": 281,
    "takengon": 282, "talu": 283, "tambelangan": 284, "tanah grogot": 285, "tangerang": 286,
    "tanjung balai": 287, "tanjung kalsel": 288, "tanjung karang": 289, "tanjung kodok": 290,
    "tanjung pandan": 291, "tanjung pinang": 292, "tanjung priok": 293, "tanjung redep": 294,
    "tanjung selor": 295, "tapak tuan": 296, "tarutung": 297, "tasikmalaya": 298, "tebing tinggi": 299,
    "tegal": 300, "teluk betung": 301, "temanggung": 302, "tembilahan": 303, "ternate": 304,
    "tobelo": 305, "tolitoli": 306, "torjun": 307, "trenggalek": 308, "tuban": 309, "tulungagung": 310,
    "ujung kulon": 311, "ujung_pandang": 312, "ujung pangkah": 314, "ujung pandang": 315, "makassar": 316,
    "waikabubak": 317, "waingapu": 318, "wamena": 319, "waru": 320, "watanpone": 321, "watansoppeng": 322,
    "wates": 323, "wonogiri": 324, "wonosari": 325, "wonosobo": 326, "yogyakarta": 327, "tarakan": 328,
    "bunyu": 329, "bulungan": 330, "barru": 331, "soroako": 332, "selayar": 333, "gowa": 334,
    "wajo": 335, "dpw aceh": 336, "masjid ar-rahmah takalar": 337, "masjid imam muslim takalar": 338,
    "mamuju (masjid nurul johar makkasau)": 339, "bombana": 340, "luwu": 341, "luwu utara": 342,
    "luwu timur": 343, "bone": 344, "wahdah islamiyah konawe": 345,
    "kabupaten buol sulawesi tengah": 346, "kecamatan melonguane": 347
};

// Ambil nama kota dari URL
const params = new URLSearchParams(window.location.search);
const kota = params.get('kota')?.toLowerCase();

if (!kota || !kotaIdMapping[kota]) {
    document.getElementById('judul').innerText = "Kota tidak ditemukan";
} else {
    fetch("https://bot-telegram-02rg.onrender.com/proxy_jadwal?kota=" + kota)
    .then(res => res.text())
    .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, "text/html");
        const title = doc.querySelector("font[style*='font-size:16px']")?.innerText || `Jadwal Sholat - ${kota}`;
        document.getElementById('judul').innerText = title;

        const table = doc.querySelector("table.table-bordered");
        if (table) {
            document.getElementById('jadwal').appendChild(table);
            $.print("#jadwal");
        } else {
            document.getElementById('jadwal').innerHTML = "Tidak dapat memuat jadwal.";
        }
    })
    .catch(err => {
        document.getElementById('jadwal').innerText = "Gagal memuat data.";
        console.error(err);
    });
}
</script>
